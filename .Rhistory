unique()
## work around for round ()
rnd <- function(x) trunc(x+sign(x)*0.5)
# Michigan Consumer Sentiments
GET("http://www.sca.isr.umich.edu/files/tbmics.xls", write_disk(sentiment <- tempfile(fileext = ".xls")))
#Preliminary data
GET("http://www.sca.isr.umich.edu/files/tbcics.xls", write_disk(sentiment_cur <- tempfile(fileext = ".xls")))
GET("http://www.sca.isr.umich.edu/files/tbmpx1px5.xls", write_disk(expect <- tempfile(fileext = ".xls")))
#Preliminary data
GET("http://www.sca.isr.umich.edu/files/tbcpx1px5.xls", write_disk(expect_cur <- tempfile(fileext = ".xls")))
#Political Affiliation
GET("https://data.sca.isr.umich.edu/get-table.php?c=RB&y=2025&m=9&n=5b&f=xls&k=a888a55c335a02fe69976efb6fa28d76", write_disk(expect_pol <- tempfile(fileext = ".xls")))
# download census-bea county crosswalk from BEA
url <- "https://apps.bea.gov/regional/xls/FIPSModifications.xlsx"
GET(url, write_disk(bea_fips <- tempfile(fileext = "xlsx")))
bea_county <- read_xlsx(bea_fips, skip = 1,col_types = "text")
names(bea_county) <- c("stco_bea_fips","stco_bea_name","stco_fips","co_name")
## GGPLOT Setups
p_guide <- guides(colour = guide_legend(override.aes = list(size=4)))
p_theme_bar_tail <-   theme_minimal() +
theme(legend.position   = " ",
legend.title      = element_blank(),
plot.margin       = margin(0, 50, 0, 10),
panel.grid.minor  = element_blank(),
strip.text        = element_text(face = "bold", color = "black"),
legend.text       = element_text(size = 12),
legend.box.margin = margin(c(-10,-10,0,-10)),
plot.caption      = element_text(hjust=0, size = 6, color = "black"),
plot.subtitle     = element_text(size=12, face = "bold", color="black"),
plot.title        = element_text(size=12, face = "bold", color="black"),
axis.text.x       = element_text(face = "bold", angle = 90, vjust = 0.5, hjust = 1, color = "black"),
axis.text.y       = element_text(face = "bold", color="black"),
axis.title.x      = element_text(size=10, face="bold"),
axis.title.y      = element_text(size=10, face="bold"))
p_theme_bar <-   theme_minimal() +
theme(legend.position   = " ",
legend.title      = element_blank(),
plot.margin       = margin(0, 10, 0, 10),
panel.grid.minor  = element_blank(),
strip.text        = element_text(face = "bold", color = "black"),
legend.text       = element_text(size = 12),
legend.box.margin = margin(c(-10,-10,0,-10)),
plot.caption      = element_text(hjust=0, size = 6, color = "black"),
plot.subtitle     = element_text(size=12, face = "bold", color="black"),
plot.title        = element_text(size=12, face = "bold", color="black"),
axis.text.x       = element_text(face = "bold", angle = 90, vjust = 0.5, hjust = 1, color = "black"),
axis.text.y       = element_text(face = "bold", color="black"),
axis.title.x      = element_text(size=10, face="bold"),
axis.title.y      = element_text(size=10, face="bold"))
p_theme_side_nolegend <- theme_minimal() +
theme(legend.position   = " ",
plot.margin       = margin(0, 80, 0, 0),
panel.grid.minor  = element_blank(),
legend.title      = element_blank(),
legend.text       = element_text(size = 12),
legend.box.margin = margin(c(-5,-5,-5,-5)),
plot.caption      = element_text(hjust=0, size = 6, color = "black"),
plot.subtitle     = element_text(size=12, face = "bold", color="black"),
plot.title        = element_text(size=12, face = "bold", color="black"),
axis.text.x       = element_text(face = "bold", angle = 90, vjust = 0.5, hjust = 1, color = "black"),
axis.title.x      = element_text(size=12, face="bold", color = "black"),
axis.text.y       = element_text(face = "bold", color = "black"),
axis.title.y      = element_text(size=12, face="bold", color = "black"))
p_theme_side_nolegend_tail <- theme_minimal() +
theme(legend.position   = " ",
plot.margin       = margin(0, 50, 0, 0),
panel.grid.minor  = element_blank(),
legend.title      = element_blank(),
legend.text       = element_text(size = 12),
legend.box.margin = margin(c(-5,-5,-5,-5)),
plot.caption      = element_text(hjust=0, size = 6, color = "black"),
plot.subtitle     = element_text(size=12, face = "bold", color="black"),
plot.title        = element_text(size=12, face = "bold", color="black"),
axis.text.x       = element_text(face = "bold", angle = 90, vjust = 0.5, hjust = 1, color = "black"),
axis.title.x      = element_text(size=12, face="bold", color = "black"),
axis.text.y       = element_text(face = "bold", color = "black"),
axis.title.y      = element_text(size=12, face="bold", color = "black"))
p_theme_side <- theme_minimal() +
theme(legend.position   = "bottom",
plot.margin       = margin(0, 70, 0, 0),
panel.grid.minor  = element_blank(),
legend.title      = element_blank(),
legend.text       = element_text(size = 12),
legend.box.margin = margin(c(-10,-10,0,-10)),
plot.caption      = element_text(hjust=0, size = 6, color = "black"),
plot.subtitle     = element_text(size=12, face = "bold", color="black"),
plot.title        = element_text(size=12, face = "bold", color="black"),
axis.text.x       = element_text(face = "bold", angle = 90, vjust = 0.5, hjust = 1, color = "black"),
axis.title.x      = element_text(size=12, face="bold", color = "black"),
axis.text.y       = element_text(face = "bold", color = "black"),
axis.title.y      = element_text(size=12, face="bold", color = "black"))
p_theme_side_tail <- theme_minimal() +
theme(legend.position   = "bottom",
plot.margin       = margin(0, 50, 0, 0),
panel.grid.minor  = element_blank(),
legend.title      = element_blank(),
legend.text       = element_text(size = 12),
legend.box.margin = margin(c(-10,-10,0,-10)),
plot.caption      = element_text(hjust=0, size = 6, color = "black"),
plot.subtitle     = element_text(size=12, face = "bold", color="black"),
plot.title        = element_text(size=12, face = "bold", color="black"),
axis.text.x       = element_text(face = "bold", angle = 90, vjust = 0.5, hjust = 1, color = "black"),
axis.title.x      = element_text(size=12, face="bold", color = "black"),
axis.text.y       = element_text(face = "bold", color = "black"),
axis.title.y      = element_text(size=12, face="bold", color = "black"))
p_theme_noside_nolegend <- theme_minimal() +
theme(legend.position   = " ",
plot.margin       = margin(0, 0, 0, 0),
panel.grid.minor  = element_blank(),
legend.title      = element_blank(),
legend.text       = element_text(size = 12),
legend.box.margin = margin(c(-5,-5,-5,-5)),
plot.caption      = element_text(hjust=0, size = 6, color = "black"),
plot.subtitle     = element_text(size=12, face = "bold", color="black"),
plot.title        = element_text(size=12, face = "bold", color="black"),
axis.text.x       = element_text(face = "bold", angle = 90, vjust = 0.5, hjust = 1, color = "black"),
axis.title.x      = element_text(size=12, face="bold", color = "black"),
axis.text.y       = element_text(face = "bold", color = "black"),
axis.title.y      = element_text(size=12, face="bold", color = "black"))
infl_comp <- tq_get(c("CUSR0000SEHF01"),
get  = "economic.data",
from = "2018-01-01" ) %>%
mutate(m_inflation = (price - lag(price, n = 12))/(lag(price, n = 12)),
c_inflation = (price - price[date == "2019-01-01"])/price[date == "2019-01-01"]) %>%
filter(date = max(date)) %>%
select(date, m_inflation, c_inflation)
infl_comp <- tq_get(c("CUSR0000SEHF01"),
get  = "economic.data",
from = "2018-01-01" ) %>%
mutate(m_inflation = (price - lag(price, n = 12))/(lag(price, n = 12)),
c_inflation = (price - price[date == "2019-01-01"])/price[date == "2019-01-01"]) %>%
filter(date == max(date)) %>%
select(date, m_inflation, c_inflation) %>%
pivot_longer(!date,
names_to = "symbol",
values_to = "value") %>%
mutate(color_group = case_when(symbol == "m_inflation" ~ "red",
TRUE ~ "darkblue"),
max_labels  = ifelse(date==max(date), value, NA))
View(infl_comp)
infl_comp <- tq_get(c("CUSR0000SEHF01"),
get  = "economic.data",
from = "2018-01-01" ) %>%
mutate(m_inflation = (price - lag(price, n = 12))/(lag(price, n = 12)),
c_inflation = (price - price[date == "2019-01-01"])/price[date == "2019-01-01"],
name        = case_when(symbol == "CUSR0000SEHF01" ~ "Electricity",
TRUE ~ NA)) %>%
filter(date == max(date)) %>%
select(date, m_inflation, c_inflation) %>%
pivot_longer(!date,
names_to = "symbol",
values_to = "value") %>%
mutate(color_group = case_when(symbol == "m_inflation" ~ "red",
TRUE ~ "darkblue"),
max_labels  = ifelse(date==max(date), value, NA))
infl_comp <- tq_get(c("CUSR0000SEHF01"),
get  = "economic.data",
from = "2018-01-01" ) %>%
mutate(m_inflation = (price - lag(price, n = 12))/(lag(price, n = 12)),
c_inflation = (price - price[date == "2019-01-01"])/price[date == "2019-01-01"],
name        = case_when(symbol == "CUSR0000SEHF01" ~ "Electricity",
TRUE ~ NA)) %>%
filter(date == max(date)) %>%
select(date, name, m_inflation, c_inflation) %>%
pivot_longer(!date,
names_to = "symbol",
values_to = "value") %>%
mutate(color_group = case_when(symbol == "m_inflation" ~ "red",
TRUE ~ "darkblue"),
max_labels  = ifelse(date==max(date), value, NA))
infl_comp <- tq_get(c("CUSR0000SEHF01"),
get  = "economic.data",
from = "2018-01-01" ) %>%
mutate(m_inflation = (price - lag(price, n = 12))/(lag(price, n = 12)),
c_inflation = (price - price[date == "2019-01-01"])/price[date == "2019-01-01"],
name        = case_when(symbol == "CUSR0000SEHF01" ~ "Electricity",
TRUE ~ NA)) %>%
filter(date == max(date)) %>%
select(date, name, m_inflation, c_inflation)
View(infl_comp)
infl_cats <- tq_get(c("CUSR0000SEHF01"),
get  = "economic.data",
from = "2018-01-01" ) %>%
mutate(m_inflation = (price - lag(price, n = 12))/(lag(price, n = 12)),
c_inflation = (price - price[date == "2019-01-01"])/price[date == "2019-01-01"],
name        = case_when(symbol == "CUSR0000SEHF01" ~ "Electricity",
TRUE ~ NA)) %>%
filter(date == max(date)) %>%
select(date, symbol, name, m_inflation, c_inflation) %>%
pivot_longer(!date,
names_to = "symbol",
values_to = "value") %>%
mutate(color_group = case_when(symbol == "m_inflation" ~ "red",
TRUE ~ "darkblue"),
max_labels  = ifelse(date==max(date), value, NA))
infl_cats <- tq_get(c("CUSR0000SEHF01"),
get  = "economic.data",
from = "2018-01-01" ) %>%
mutate(m_inflation = (price - lag(price, n = 12))/(lag(price, n = 12)),
c_inflation = (price - price[date == "2019-01-01"])/price[date == "2019-01-01"],
name        = case_when(symbol == "CUSR0000SEHF01" ~ "Electricity",
TRUE ~ NA)) %>%
filter(date == max(date)) %>%
select(date, symbol, name, m_inflation, c_inflation)
View(infl_cats)
infl_cats <- tq_get(c("CUSR0000SEHF01",
"CUUR0000SEHD",
"CUSR0000SETD"),
get  = "economic.data",
from = "2018-01-01" ) %>%
mutate(m_inflation = (price - lag(price, n = 12))/(lag(price, n = 12)),
c_inflation = (price - price[date == "2019-01-01"])/price[date == "2019-01-01"],
name        = case_when(symbol == "CUSR0000SEHF01" ~ "Electricity",
symbol == "CUUR0000SEHD" ~ "Household Insurance",
symbol == "CUSR0000SETD" ~ "Car Repair",
TRUE ~ NA)) %>%
filter(date == max(date)) %>%
select(date, symbol, name, m_inflation, c_inflation)
View(infl_cats)
infl_cats <- tq_get(c("CUSR0000SEHF01",
"CUUR0000SEHD",
"CUSR0000SETD",
"CUSR0000SEFP01",
"CUSR0000SAF113",
"CUSR0000SAM2"),
get  = "economic.data",
from = "2018-01-01" ) %>%
mutate(m_inflation = (price - lag(price, n = 12))/(lag(price, n = 12)),
c_inflation = (price - price[date == "2019-01-01"])/price[date == "2019-01-01"],
name        = case_when(symbol == "CUSR0000SEHF01" ~ "Electricity",
symbol == "CUUR0000SEHD" ~ "Household Insurance",
symbol == "CUSR0000SETD" ~ "Car Repair",
symbol == "CUSR0000SEFP01" ~ "Coffee",
symbol == "CUSR0000SAF113" ~ "Fruits and Vegetables",
symbol == "CUSR0000SAM2" ~ "Medical Care Services",
TRUE ~ NA)) %>%
filter(date == max(date)) %>%
select(date, symbol, name, m_inflation, c_inflation)
View(infl_cats)
DEFICIT <- tq_get("MTSDS133FMS",
get  = "economic.data",
from = "2000-01-01")  %>%
mutate(month = factor(month(date),
levels = c(10:12, 1:9),
labels = c(month.abb[10:12], month.abb[1:9]))) %>%
mutate(fy = year(date) + (month(date) >= 10),
value = price) %>%
filter(fy > 2021) %>%
rename(month_deficit = value) %>%
group_by(fy) %>%
mutate(deficit_sum = cumsum((-1*month_deficit/1000)))
#spread(fy, deficit_sum)
chartdate <- DEFICIT %>%
ungroup() %>%
mutate(month_mindate = lubridate::month(min(date), label = TRUE, abbr = FALSE),
year_mindate  = lubridate::year(min(date)),
month_maxdate = lubridate::month(max(date), label = TRUE, abbr = FALSE),
year_maxdate  = lubridate::year(max(date)))%>%
filter(date == max(date)) %>%
mutate(title    = "Cumulative U.S. Federal Government Deficit by Month",
subtitle = paste0("Fiscal Year ", month_mindate," ", year_mindate, " - ", month_maxdate," ", year_maxdate),
xaxis    = NULL,
yaxis    = "Billions of Nominal Dollars",
caption  = 'Sources: Congressional Budget Office, U.S. Department of the Treasury. Fiscal year runs from October of the preceding year to September of the current year.')
ggplot(data = DEFICIT,
aes(x = month,
y = deficit_sum,
group = factor(fy),
color = factor(fy))) +
geom_line(size = 1) +
scale_y_continuous(labels=scales::label_dollar()) +
scale_x_discrete(expand = expansion(mult = c(0.02, -0.00))) +
scale_color_manual(values = c("green4", "purple", "darkblue", "red")) +
geom_label_repel(data = . %>%
filter(date == max(date) & fy == "2025"),
aes(label = scales::label_dollar(a = 1)(deficit_sum)),
nudge_y = 500,
size = 6,
show.legend = FALSE,
fontface="bold",
segment.linetype = 'dotted') +
geom_label_repel(data = . %>%
filter(date == max(date) & fy == "2023"),
aes(label = scales::label_dollar(a = 1)(deficit_sum)),
nudge_x = 1.8,
size = 5,
show.legend = FALSE,
fontface="bold",
segment.linetype = 'dotted') +
geom_label_repel(data = . %>%
filter(date == max(date) & fy == "2024"),
aes(label = scales::label_dollar(a = 1)(deficit_sum)),
nudge_y = 300,
nudge_x = 1.8,
size = 5,
show.legend = FALSE,
fontface="bold",
segment.linetype = 'dotted') +
geom_label_repel(data = . %>%
filter(date == max(date) & fy == "2022"),
aes(label = scales::label_dollar(a = 1)(deficit_sum)),
nudge_y = -650,
size = 5,
show.legend = FALSE,
fontface="bold",
segment.linetype = 'dotted') +
theme_minimal()+
p_theme_side_tail+
guides(colour = guide_legend(override.aes = list(size=3))) +
labs(x        =  chartdate$xaxis,
y        =  chartdate$yaxis,
title    =  chartdate$title,
subtitle =  chartdate$subtitle,
caption  =  chartdate$caption)
quarto::quarto_render()
quarto::quarto_render()
quarto::quarto_render()
library(dplyr, quietly = TRUE)
library(ggplot2, quietly = TRUE)
library(kableExtra, quietly = TRUE)
library(tidyquant, quietly = TRUE)
rm(list = ls())
library(dplyr)
library(ggplot2)
library(tidyverse)
library(tidyquant)
library(scales)
df_3 <- tq_get(c('UNRATE', 'CPIAUCSL'),
get  = 'economic.data',
from = '1969-01-01') %>%
pivot_wider(names_from = symbol, values_from = price) %>%
mutate(inflation = (CPIAUCSL - lag(CPIAUCSL, 12)) / lag(CPIAUCSL, 12),
UNRATE    = UNRATE/100) %>%
filter(!is.na(inflation))
ggplot(data = df_3,
aes(x = inflation,
y = UNRATE)) +
geom_point() +
scale_x_continuous(labels = scales::percent) +
scale_y_continuous(labels = scales::percent) +
theme_classic() +
labs(x = "Inflation (YoY %)",
y = "Unemployment Rate (%)",
title = "Scatterplot of Inflation and Unemployment")
df_4 <- df_3 %>%
summarize(mean_inf = mean(inflation),
mean_unr = mean(UNRATE),
cov_i_u  = cov(inflation, UNRATE))
kable(df_4,
col.names = c('Mean Inflation',
'Mean Unemployment',
'Covariance Inflation and Unemployment'),
align     = 'c') %>%
kable_classic()
rm(list = ls())
library(dplyr)
library(ggplot2)
library(tidyverse)
library(tidyquant)
library(scales)
df_5 <- tq_get(c('UNRATE', 'CPIAUCSL'),
get  = 'economic.data',
from = '1969-01-01') %>%
pivot_wider(names_from = symbol, values_from = price) %>%
mutate(inflation = (CPIAUCSL - lag(CPIAUCSL, 12)) / lag(CPIAUCSL, 12),
unrate    = UNRATE/100) %>%
filter(!is.na(inflation)) %>%
mutate(unrate_2 = unrate *100,
inflation_2 = inflation * 1000) %>%
summarize(cov_i_u     = cov(inflation, unrate),
cov_i2_u    = cov(inflation_2, unrate),
cov_i_u2    = cov(inflation, unrate_2),
cor_i_u     = cor(inflation, unrate),
cor_i2_u    = cor(inflation_2, unrate),
cor_i_u2    = cor(inflation, unrate_2),
cor_i2_u2   = cor(inflation_2, unrate_2))
kable(df_5,
align = 'c',
digits = 3,
col.names = c('COV(Inf, Unemp)', 'COV(Inf2, Unemp)',
'COV(Inf, Unemp2)', 'COR(Inf,Unemp)',
'COR(Inf2, Unemp)', 'COR(Inf, Unemp2)',
'COR(Inf2, Unemp2)'))
library(dplyr, quietly = TRUE)
library(ggplot2, quietly = TRUE)
library(kableExtra, quietly = TRUE)
library(tidyquant, quietly = TRUE)
rm(list = ls())
library(dplyr)
library(kableExtra)
n = 10
x = 7
p = 0.95
fx <- tibble(pmf <- dbinom(x, n, p),
cdf <- pbinom(x, n, p),
cdf_a <- dbinom(0, 10, 0.95) + dbinom(1, 10, 0.95) +
dbinom(2, 10, 0.95) + dbinom(3, 10, 0.95) +
dbinom(4, 10, 0.95) + dbinom(5, 10, 0.95) +
dbinom(6, 10, 0.95) + dbinom(7, 10, 0.95))
kable(fx,
align       = "c",
digits      = 4,
caption     = "N = 10 and p = 0.95",
col.names   = c("PMF(X = x) ", "CDF(X <= x)", "CDF(X <= x)")) %>%
kable_styling(font_size = 14,
full_width = TRUE)
library(dplyr, quietly = TRUE)
library(ggplot2, quietly = TRUE)
library(kableExtra, quietly = TRUE)
library(tidyquant, quietly = TRUE)
rm(list = ls())
library(dplyr)
library(kableExtra)
# mu_60 = 10 per 60 seconds
# mu_15 = 2.5 per 15 second
poissons <- tibble(p_x0_1min <- dpois(0, 10),
p_x12_1min <- ppois(12, 10),
p_xle3_1min <- ppois(3, 10),
p_x0_15sec <- dpois(0, 2.5),
p_xge1_15sec <- 1-dpois(0, 2.5))
kable(poissons,
align       = "ccccc",
format.args = list(big.mark = ",", scientific = FALSE),
caption     = "Poisson Distribution Example",
col.names   = c("P(x = 0, 1 min)",
"P(x <= 12, 1 min)",
"P(x <= 3, 1 min)",
"P(x=0, 15 sec)",
"P(x>0, 15 sec)")) %>%
kable_styling(font_size = 14)
library(dplyr, quietly = TRUE)
library(ggplot2, quietly = TRUE)
library(kableExtra, quietly = TRUE)
library(tidyquant, quietly = TRUE)
qexp(0.86, lambda, lower.tail = FALSE))
qexp(0.86, lambda, lower.tail = FALSE)
library(dplyr, quietly = TRUE)
library(ggplot2, quietly = TRUE)
library(kableExtra, quietly = TRUE)
library(tidyquant, quietly = TRUE)
rm(list = ls())
set.seed(123)
library(dplyr)
library(kableExtra)
mu = 15
lambda = 1/mu
exp_1 <- tibble(q1 <- pexp(6, lambda, lower.tail = TRUE),
q2 <- pexp(20, lambda, lower.tail = FALSE),
q3 <- pexp(18, lambda, lower.tail = TRUE) -
pexp(12, lambda, lower.tail = TRUE),
q4 <- qexp(0.2, lambda, lower.tail = TRUE),
q5 <- qexp(0.86, lambda, lower.tail = FALSE))
kable(exp_1,
align     = 'c',
digits    = 3,
caption   = 'Exponential Distribution Example',
col.names = c('P(X < 6)',
'P(X > 20)',
'P(12 < X < 18)',
'P(20)',
'P(85)')) %>%
kable_styling(font_size = 12)
qexp(0.86, lambda, lower.tail = FALSE))
qexp(0.86, lambda, lower.tail = FALSE)
1-qexp(0.85, lambda)
qexp(0.85, lambda)
qexp(0.2, lambda)
rm(list = ls())
set.seed(123)
library(dplyr)
library(kableExtra)
mu = 15
lambda = 1/mu
exp_1 <- tibble(q1 <- pexp(6, lambda, lower.tail = TRUE),
q2 <- pexp(20, lambda, lower.tail = FALSE),
q3 <- pexp(18, lambda, lower.tail = TRUE) -
pexp(12, lambda, lower.tail = TRUE),
q4 <- qexp(0.2, lambda, lower.tail = TRUE),
q5 <- qexp(0.85, lambda, lower.tail = FALSE))
kable(exp_1,
align     = 'c',
digits    = 3,
caption   = 'Exponential Distribution Example',
col.names = c('P(X < 6)',
'P(X > 20)',
'P(12 < X < 18)',
'P(20)',
'P(85)')) %>%
kable_styling(font_size = 12)
rm(list = ls())
set.seed(123)
library(dplyr)
library(kableExtra)
mu = 15
lambda = 1/mu
exp_1 <- tibble(q1 <- pexp(6, lambda, lower.tail = TRUE),
q2 <- pexp(20, lambda, lower.tail = FALSE),
q3 <- pexp(18, lambda, lower.tail = TRUE) -
pexp(12, lambda, lower.tail = TRUE),
q4 <- qexp(0.2, lambda, lower.tail = TRUE),
q5 <- qexp(0.15, lambda, lower.tail = FALSE))
kable(exp_1,
align     = 'c',
digits    = 3,
caption   = 'Exponential Distribution Example',
col.names = c('P(X < 6)',
'P(X > 20)',
'P(12 < X < 18)',
'P(20)',
'P(85)')) %>%
kable_styling(font_size = 12)
quarto::quarto_render()
