".bold"                = list("font-weight"      = "700"),
".remark-slide-content.agenda-slide"             = list("background-color" = "#003057",                                                                                                                         "font-size"        = "1rem",
"width"            = "100%",
"height"           = "100%"),
".remark-slide-content.full-slide"               = list("background-color" = "#FFFFFF",
"font-size"        = "1rem",
"padding"          = "0px 0px 0px 0px",
"width"            = "100%",
"height"           = "100%"),
"div.my-footer"        = list("background-color" = "#003057",
"position"         = "absolute",
"bottom"           = "0px",
"left"             = "0px",
"height"           = "20px",
"width"            = "100%"),
"div.my-footer span"   = list("font-size"        = "10pt",
"color"            = "#FFFFFF",
"position"         = "absolute",
"left"             = "15px",
"bottom"           = "2px",
"width"            = "100%"),
".slateblue"           = list("color"            = "#445d6d"),
".covergreen"          = list("color"            = "#5c8c9b"),
".headerblue"          = list("color"            = "#003057"),
".forestgreen"         = list("color"            = "#172d13"),
".pull-left-above"     = list("margin-top"       = "105px",
"position"         = "absolute",
"white-space"      = "pre-line",
"color"            = "white"),
".pull-left-above2"    = list("margin-top"       = "45px",
"position"         = "absolute",
"white-space"      = "pre-line",
"color"            = "white"),
".pull-top"            = list("margin-top"       = "-30px",
"position"         = "absolute",
"white-space"      = "pre-line",
"color"            = "white"),
".pull-top2"           = list("margin-top"       = "-30px",
"margin-left"      = "5px",
"white-space"      = "pre-line",
"color"            = "white",
"text-align"       = "left"),
".credit"               = list("font-size"        = "35%",
"bottom"           = "1vw",
"margin-left"      = "-5px",
"white-space"      = "pre-line",
"position"         = "absolute",
"opacity"          = "70%",
"color"            = "white"),
".middle2"             = list("margin-top"       = "100px",
"margin-left"      = "-20px",
"margin-right"     = "40%",
'margin-bottom'    = '50px',
"position"         = "absolute"),
".middle3"             = list("margin-top"       = "100px",
"margin-left"      = "-40%",
"margin-right"     = "40%",
'margin-bottom'    = '10px',
"position"         = "absolute"),
".vvlarge2"            = list("font-size"        = "250%",
"white-space"      = "pre-line"),
".bottom"              = list("bottom"           = "30px",
"margin-left"      = "-20px",
"position"         = "absolute"),
".top2"                = list("margin-top"       = "120px"),
".pull-left-third"     = list("float"            = "left",
"width"            = "31%"),
".pull-right-third"    = list("float"            = "right",
"width"            = "36%"),
".pull-middle-third"   = list("float"            = "left",
"width"            = "26%",
"margin"           = "0 3%"),
".slarge2"             = list("font-size"        = "115%",
"white-space"      = "pre-line"),
".two-column-slide. column"                      = list("display"         = "flex",
"justify-content" = "center",
"align-items"     = "center"),
".two-column-slide. column.image-column"         = list("width"           = "50%",
"height"          = "auto"),
".two-column-slide. column.text-column"          = list("width"           = "50%"),
".pull-left-uneven"     = list("float"            = "left",
"width"            = "31%"),
".pull-right-uneven"    = list("float"            = "right",
"width"            = "65%"),
".bottom-center"        = list("position"   = "absolute",
"bottom"     = "30px",
"width"      = "90%",
"text-align" = "center",
"font-size"       = "150%"),
".center-break"         = list("white-space"      = "pre-line",
"position"         = "absolute",
"top"        = "25%",
"left"       = "0%",
"width"      = "100%",
"text-align" = "center",
"font-size"  = "120%",
"colour"     = "#fffff0"),
".two-column-uneven"                 = list("display"         = "flex",
"align-items"     = "center",
"gap"             = "10px",
"padding-left"    = "10px"),
".two-column-uneven.image"           = list("width"           = "50%"),
".two-column-uneven.text"            = list("width"           = "50%")))
# Set API Keys
beaKey <- "B1BB2184-82B3-4408-BF59-D9BFB398AA06"
blskey <- "feaaaa8be5a94270a1aeef1cd2c098d4"
census_api_key("9c1637a56ff93f0af6b4b1d0547ea048fe668175", overwrite = TRUE, install=TRUE)
#### I-94 Monthly International visitor Arrivals yoy
GET(
'https://www.trade.gov//sites/default/files/2024-06/Monthly%20Arrivals%202000%20to%20Present%20%E2%80%93%20Country%20of%20Residence%20%28COR%29_1.xlsx',
write_disk(tourism1 <- tempfile(fileext = '.xlsx'))
)
#ZVHI Single Family Homes Time Series - State
url1 <- "https://files.zillowstatic.com/research/public_csvs/zhvi/State_zhvi_uc_sfr_tier_0.33_0.67_sm_sa_month.csv?t=1635176196"
GET(url1, write_disk(tf_zstate <- tempfile(fileext = ".csv")))
#ZVHI Single Family Homes Time Series - U.S. and Metro
url2 <- "https://files.zillowstatic.com/research/public_csvs/zhvi/Metro_zhvi_uc_sfr_tier_0.33_0.67_sm_sa_month.csv?t=1635176196"
GET(url2, write_disk(tf_zus <- tempfile(fileext = ".csv")))
#ZVHI All Homes (SFR, Condo) Time Series, Smoothed, Seasonally
url2_0 <- "https://files.zillowstatic.com/research/public_csvs/zhvi/Metro_zhvi_uc_sfrcondo_tier_0.33_0.67_sm_sa_month.csv?t=1726168225"
GET(url2_0, write_disk(tf_zus_all <- tempfile(fileext = ".csv")))
#ZORI All homes and Multi-Family Residences
url3 <- "https://files.zillowstatic.com/research/public_csvs/zori/Metro_zori_uc_sfrcondomfr_sm_sa_month.csv?t=1707226355"
GET(url3, write_disk(tf_zori <- tempfile(fileext = ".csv")))
#ZORI Multi-Family Residences Smooothed Seasonally
url3_0 <- "https://files.zillowstatic.com/research/public_csvs/zori/Metro_zori_uc_mfr_sm_sa_month.csv?t=1759172481"
GET(url3_0, write_disk(tf_zorim <- tempfile(fileext = ".csv")))
zorim <- read_csv(tf_zorim)
#Permits by CBSA
url4 <- "https://www.census.gov/construction/bps/xls/cbsamonthly_202406.xls"
GET(url4, write_disk(tf_permit <- tempfile(fileext = ".csv")))
#UI and continued claims
GET('https://virginiaworks.com/_docs/Download-Center/weekly_claimants/weekly_claimants.xlsx',
write_disk(ui_cont <- tempfile(fileext = '.xlsx')))
#State and Metro Seasonal Unemployment
GET(url = "https://www.bls.gov/web/metro/ssamatab1.zip",
write_disk(temp_emp_zip <- tempfile(pattern = "ssamatab1", fileext = ".zip")),
user_agent('rmcnab@odu.edu'))
metro_employ <- read_xlsx(unzip(temp_emp_zip, "ssamatab1.xlsx",  overwrite = TRUE),
col_names = c("LAUS Code",
"State FIPS Code",
"Area FIPS Code",
"Area",
"Year",
"Month",
"Civilian Labor Force",
"Employment",
"Unemployment",
"Unemployment Rate")) %>%
clean_names() %>%
filter(year != "NA" & year != "Year")
# Hampton Roads Cities and Counties
url1 <- 'https://www2.census.gov/programs-surveys/metro-micro/geographies/reference-files/2023/delineation-files/list1_2023.xlsx'
GET(url1, write_disk(tf <- tempfile(fileext = ".xlsx")))
hr_county <- read_excel(tf,
sheet="List 1",
range = "A3:L1918") %>%
clean_names() %>%
mutate(fips = paste0(fips_state_code, fips_county_code)) %>%
rename(cbsa = cbsa_code,
cbsa_name = cbsa_title,
statefip = fips_state_code,
county = county_county_equivalent) %>%
filter(cbsa == 47260) %>%
select(cbsa, fips, county, cbsa_name)
nova_county <- read_excel(tf,
sheet="List 1",
range = "A3:L1918") %>%
clean_names() %>%
mutate(fips = paste0(fips_state_code, fips_county_code)) %>%
rename(cbsa = cbsa_code,
cbsa_name = cbsa_title,
statefip = fips_state_code,
county = county_county_equivalent) %>%
filter(cbsa == 47900) %>%
select(cbsa, fips, county, cbsa_name)
rich_county <- read_excel(tf,
sheet="List 1",
range = "A3:L1918") %>%
clean_names() %>%
mutate(fips = paste0(fips_state_code, fips_county_code)) %>%
rename(cbsa = cbsa_code,
cbsa_name = cbsa_title,
statefip = fips_state_code,
county = county_county_equivalent) %>%
filter(cbsa == 40060) %>%
select(cbsa, fips, county, cbsa_name)
msa_list <- read_excel(tf,
sheet="List 1",
range = "A3:L1918") %>%
clean_names() %>%
mutate(fips = paste0(fips_state_code, fips_county_code)) %>%
rename(cbsa = cbsa_code,
cbsa_name = cbsa_title,
statefip = fips_state_code,
county = county_county_equivalent) %>%
filter(metropolitan_micropolitan_statistical_area == "Metropolitan Statistical Area") %>%
select(cbsa, cbsa_name) %>%
unique()
## work around for round ()
rnd <- function(x) trunc(x+sign(x)*0.5)
# Michigan Consumer Sentiments
GET("http://www.sca.isr.umich.edu/files/tbmics.xls", write_disk(sentiment <- tempfile(fileext = ".xls")))
#Preliminary data
GET("http://www.sca.isr.umich.edu/files/tbcics.xls", write_disk(sentiment_cur <- tempfile(fileext = ".xls")))
GET("http://www.sca.isr.umich.edu/files/tbmpx1px5.xls", write_disk(expect <- tempfile(fileext = ".xls")))
#Preliminary data
GET("http://www.sca.isr.umich.edu/files/tbcpx1px5.xls", write_disk(expect_cur <- tempfile(fileext = ".xls")))
#Political Affiliation
GET("https://data.sca.isr.umich.edu/get-table.php?c=RB&y=2025&m=9&n=5b&f=xls&k=a888a55c335a02fe69976efb6fa28d76", write_disk(expect_pol <- tempfile(fileext = ".xls")))
# download census-bea county crosswalk from BEA
url <- "https://apps.bea.gov/regional/xls/FIPSModifications.xlsx"
GET(url, write_disk(bea_fips <- tempfile(fileext = "xlsx")))
bea_county <- read_xlsx(bea_fips, skip = 1,col_types = "text")
names(bea_county) <- c("stco_bea_fips","stco_bea_name","stco_fips","co_name")
## GGPLOT Setups
p_guide <- guides(colour = guide_legend(override.aes = list(size=4)))
p_theme_bar_tail <-   theme_minimal() +
theme(legend.position   = " ",
legend.title      = element_blank(),
plot.margin       = margin(0, 50, 0, 10),
panel.grid.minor  = element_blank(),
strip.text        = element_text(face = "bold", color = "black"),
legend.text       = element_text(size = 12),
legend.box.margin = margin(c(-10,-10,0,-10)),
plot.caption      = element_text(hjust=0, size = 6, color = "black"),
plot.subtitle     = element_text(size=12, face = "bold", color="black"),
plot.title        = element_text(size=12, face = "bold", color="black"),
axis.text.x       = element_text(face = "bold", angle = 90, vjust = 0.5, hjust = 1, color = "black"),
axis.text.y       = element_text(face = "bold", color="black"),
axis.title.x      = element_text(size=10, face="bold"),
axis.title.y      = element_text(size=10, face="bold"))
p_theme_bar <-   theme_minimal() +
theme(legend.position   = " ",
legend.title      = element_blank(),
plot.margin       = margin(0, 10, 0, 10),
panel.grid.minor  = element_blank(),
strip.text        = element_text(face = "bold", color = "black"),
legend.text       = element_text(size = 12),
legend.box.margin = margin(c(-10,-10,0,-10)),
plot.caption      = element_text(hjust=0, size = 6, color = "black"),
plot.subtitle     = element_text(size=12, face = "bold", color="black"),
plot.title        = element_text(size=12, face = "bold", color="black"),
axis.text.x       = element_text(face = "bold", angle = 90, vjust = 0.5, hjust = 1, color = "black"),
axis.text.y       = element_text(face = "bold", color="black"),
axis.title.x      = element_text(size=10, face="bold"),
axis.title.y      = element_text(size=10, face="bold"))
p_theme_side_nolegend <- theme_minimal() +
theme(legend.position   = " ",
plot.margin       = margin(0, 80, 0, 0),
panel.grid.minor  = element_blank(),
legend.title      = element_blank(),
legend.text       = element_text(size = 12),
legend.box.margin = margin(c(-5,-5,-5,-5)),
plot.caption      = element_text(hjust=0, size = 6, color = "black"),
plot.subtitle     = element_text(size=12, face = "bold", color="black"),
plot.title        = element_text(size=12, face = "bold", color="black"),
axis.text.x       = element_text(face = "bold", angle = 90, vjust = 0.5, hjust = 1, color = "black"),
axis.title.x      = element_text(size=12, face="bold", color = "black"),
axis.text.y       = element_text(face = "bold", color = "black"),
axis.title.y      = element_text(size=12, face="bold", color = "black"))
p_theme_side_nolegend_tail <- theme_minimal() +
theme(legend.position   = " ",
plot.margin       = margin(0, 50, 0, 0),
panel.grid.minor  = element_blank(),
legend.title      = element_blank(),
legend.text       = element_text(size = 12),
legend.box.margin = margin(c(-5,-5,-5,-5)),
plot.caption      = element_text(hjust=0, size = 6, color = "black"),
plot.subtitle     = element_text(size=12, face = "bold", color="black"),
plot.title        = element_text(size=12, face = "bold", color="black"),
axis.text.x       = element_text(face = "bold", angle = 90, vjust = 0.5, hjust = 1, color = "black"),
axis.title.x      = element_text(size=12, face="bold", color = "black"),
axis.text.y       = element_text(face = "bold", color = "black"),
axis.title.y      = element_text(size=12, face="bold", color = "black"))
p_theme_side <- theme_minimal() +
theme(legend.position   = "bottom",
plot.margin       = margin(0, 70, 0, 0),
panel.grid.minor  = element_blank(),
legend.title      = element_blank(),
legend.text       = element_text(size = 12),
legend.box.margin = margin(c(-10,-10,0,-10)),
plot.caption      = element_text(hjust=0, size = 6, color = "black"),
plot.subtitle     = element_text(size=12, face = "bold", color="black"),
plot.title        = element_text(size=12, face = "bold", color="black"),
axis.text.x       = element_text(face = "bold", angle = 90, vjust = 0.5, hjust = 1, color = "black"),
axis.title.x      = element_text(size=12, face="bold", color = "black"),
axis.text.y       = element_text(face = "bold", color = "black"),
axis.title.y      = element_text(size=12, face="bold", color = "black"))
p_theme_side_tail <- theme_minimal() +
theme(legend.position   = "bottom",
plot.margin       = margin(0, 50, 0, 0),
panel.grid.minor  = element_blank(),
legend.title      = element_blank(),
legend.text       = element_text(size = 12),
legend.box.margin = margin(c(-10,-10,0,-10)),
plot.caption      = element_text(hjust=0, size = 6, color = "black"),
plot.subtitle     = element_text(size=12, face = "bold", color="black"),
plot.title        = element_text(size=12, face = "bold", color="black"),
axis.text.x       = element_text(face = "bold", angle = 90, vjust = 0.5, hjust = 1, color = "black"),
axis.title.x      = element_text(size=12, face="bold", color = "black"),
axis.text.y       = element_text(face = "bold", color = "black"),
axis.title.y      = element_text(size=12, face="bold", color = "black"))
p_theme_noside_nolegend <- theme_minimal() +
theme(legend.position   = " ",
plot.margin       = margin(0, 0, 0, 0),
panel.grid.minor  = element_blank(),
legend.title      = element_blank(),
legend.text       = element_text(size = 12),
legend.box.margin = margin(c(-5,-5,-5,-5)),
plot.caption      = element_text(hjust=0, size = 6, color = "black"),
plot.subtitle     = element_text(size=12, face = "bold", color="black"),
plot.title        = element_text(size=12, face = "bold", color="black"),
axis.text.x       = element_text(face = "bold", angle = 90, vjust = 0.5, hjust = 1, color = "black"),
axis.title.x      = element_text(size=12, face="bold", color = "black"),
axis.text.y       = element_text(face = "bold", color = "black"),
axis.title.y      = element_text(size=12, face="bold", color = "black"))
infl_comp <- tq_get(c("CUSR0000SEHF01"),
get  = "economic.data",
from = "2018-01-01" ) %>%
mutate(m_inflation = (price - lag(price, n = 12))/(lag(price, n = 12)),
c_inflation = (price - price[date == "2019-01-01"])/price[date == "2019-01-01"]) %>%
filter(date = max(date)) %>%
select(date, m_inflation, c_inflation)
infl_comp <- tq_get(c("CUSR0000SEHF01"),
get  = "economic.data",
from = "2018-01-01" ) %>%
mutate(m_inflation = (price - lag(price, n = 12))/(lag(price, n = 12)),
c_inflation = (price - price[date == "2019-01-01"])/price[date == "2019-01-01"]) %>%
filter(date == max(date)) %>%
select(date, m_inflation, c_inflation) %>%
pivot_longer(!date,
names_to = "symbol",
values_to = "value") %>%
mutate(color_group = case_when(symbol == "m_inflation" ~ "red",
TRUE ~ "darkblue"),
max_labels  = ifelse(date==max(date), value, NA))
View(infl_comp)
infl_comp <- tq_get(c("CUSR0000SEHF01"),
get  = "economic.data",
from = "2018-01-01" ) %>%
mutate(m_inflation = (price - lag(price, n = 12))/(lag(price, n = 12)),
c_inflation = (price - price[date == "2019-01-01"])/price[date == "2019-01-01"],
name        = case_when(symbol == "CUSR0000SEHF01" ~ "Electricity",
TRUE ~ NA)) %>%
filter(date == max(date)) %>%
select(date, m_inflation, c_inflation) %>%
pivot_longer(!date,
names_to = "symbol",
values_to = "value") %>%
mutate(color_group = case_when(symbol == "m_inflation" ~ "red",
TRUE ~ "darkblue"),
max_labels  = ifelse(date==max(date), value, NA))
infl_comp <- tq_get(c("CUSR0000SEHF01"),
get  = "economic.data",
from = "2018-01-01" ) %>%
mutate(m_inflation = (price - lag(price, n = 12))/(lag(price, n = 12)),
c_inflation = (price - price[date == "2019-01-01"])/price[date == "2019-01-01"],
name        = case_when(symbol == "CUSR0000SEHF01" ~ "Electricity",
TRUE ~ NA)) %>%
filter(date == max(date)) %>%
select(date, name, m_inflation, c_inflation) %>%
pivot_longer(!date,
names_to = "symbol",
values_to = "value") %>%
mutate(color_group = case_when(symbol == "m_inflation" ~ "red",
TRUE ~ "darkblue"),
max_labels  = ifelse(date==max(date), value, NA))
infl_comp <- tq_get(c("CUSR0000SEHF01"),
get  = "economic.data",
from = "2018-01-01" ) %>%
mutate(m_inflation = (price - lag(price, n = 12))/(lag(price, n = 12)),
c_inflation = (price - price[date == "2019-01-01"])/price[date == "2019-01-01"],
name        = case_when(symbol == "CUSR0000SEHF01" ~ "Electricity",
TRUE ~ NA)) %>%
filter(date == max(date)) %>%
select(date, name, m_inflation, c_inflation)
View(infl_comp)
infl_cats <- tq_get(c("CUSR0000SEHF01"),
get  = "economic.data",
from = "2018-01-01" ) %>%
mutate(m_inflation = (price - lag(price, n = 12))/(lag(price, n = 12)),
c_inflation = (price - price[date == "2019-01-01"])/price[date == "2019-01-01"],
name        = case_when(symbol == "CUSR0000SEHF01" ~ "Electricity",
TRUE ~ NA)) %>%
filter(date == max(date)) %>%
select(date, symbol, name, m_inflation, c_inflation) %>%
pivot_longer(!date,
names_to = "symbol",
values_to = "value") %>%
mutate(color_group = case_when(symbol == "m_inflation" ~ "red",
TRUE ~ "darkblue"),
max_labels  = ifelse(date==max(date), value, NA))
infl_cats <- tq_get(c("CUSR0000SEHF01"),
get  = "economic.data",
from = "2018-01-01" ) %>%
mutate(m_inflation = (price - lag(price, n = 12))/(lag(price, n = 12)),
c_inflation = (price - price[date == "2019-01-01"])/price[date == "2019-01-01"],
name        = case_when(symbol == "CUSR0000SEHF01" ~ "Electricity",
TRUE ~ NA)) %>%
filter(date == max(date)) %>%
select(date, symbol, name, m_inflation, c_inflation)
View(infl_cats)
infl_cats <- tq_get(c("CUSR0000SEHF01",
"CUUR0000SEHD",
"CUSR0000SETD"),
get  = "economic.data",
from = "2018-01-01" ) %>%
mutate(m_inflation = (price - lag(price, n = 12))/(lag(price, n = 12)),
c_inflation = (price - price[date == "2019-01-01"])/price[date == "2019-01-01"],
name        = case_when(symbol == "CUSR0000SEHF01" ~ "Electricity",
symbol == "CUUR0000SEHD" ~ "Household Insurance",
symbol == "CUSR0000SETD" ~ "Car Repair",
TRUE ~ NA)) %>%
filter(date == max(date)) %>%
select(date, symbol, name, m_inflation, c_inflation)
View(infl_cats)
infl_cats <- tq_get(c("CUSR0000SEHF01",
"CUUR0000SEHD",
"CUSR0000SETD",
"CUSR0000SEFP01",
"CUSR0000SAF113",
"CUSR0000SAM2"),
get  = "economic.data",
from = "2018-01-01" ) %>%
mutate(m_inflation = (price - lag(price, n = 12))/(lag(price, n = 12)),
c_inflation = (price - price[date == "2019-01-01"])/price[date == "2019-01-01"],
name        = case_when(symbol == "CUSR0000SEHF01" ~ "Electricity",
symbol == "CUUR0000SEHD" ~ "Household Insurance",
symbol == "CUSR0000SETD" ~ "Car Repair",
symbol == "CUSR0000SEFP01" ~ "Coffee",
symbol == "CUSR0000SAF113" ~ "Fruits and Vegetables",
symbol == "CUSR0000SAM2" ~ "Medical Care Services",
TRUE ~ NA)) %>%
filter(date == max(date)) %>%
select(date, symbol, name, m_inflation, c_inflation)
View(infl_cats)
DEFICIT <- tq_get("MTSDS133FMS",
get  = "economic.data",
from = "2000-01-01")  %>%
mutate(month = factor(month(date),
levels = c(10:12, 1:9),
labels = c(month.abb[10:12], month.abb[1:9]))) %>%
mutate(fy = year(date) + (month(date) >= 10),
value = price) %>%
filter(fy > 2021) %>%
rename(month_deficit = value) %>%
group_by(fy) %>%
mutate(deficit_sum = cumsum((-1*month_deficit/1000)))
#spread(fy, deficit_sum)
chartdate <- DEFICIT %>%
ungroup() %>%
mutate(month_mindate = lubridate::month(min(date), label = TRUE, abbr = FALSE),
year_mindate  = lubridate::year(min(date)),
month_maxdate = lubridate::month(max(date), label = TRUE, abbr = FALSE),
year_maxdate  = lubridate::year(max(date)))%>%
filter(date == max(date)) %>%
mutate(title    = "Cumulative U.S. Federal Government Deficit by Month",
subtitle = paste0("Fiscal Year ", month_mindate," ", year_mindate, " - ", month_maxdate," ", year_maxdate),
xaxis    = NULL,
yaxis    = "Billions of Nominal Dollars",
caption  = 'Sources: Congressional Budget Office, U.S. Department of the Treasury. Fiscal year runs from October of the preceding year to September of the current year.')
ggplot(data = DEFICIT,
aes(x = month,
y = deficit_sum,
group = factor(fy),
color = factor(fy))) +
geom_line(size = 1) +
scale_y_continuous(labels=scales::label_dollar()) +
scale_x_discrete(expand = expansion(mult = c(0.02, -0.00))) +
scale_color_manual(values = c("green4", "purple", "darkblue", "red")) +
geom_label_repel(data = . %>%
filter(date == max(date) & fy == "2025"),
aes(label = scales::label_dollar(a = 1)(deficit_sum)),
nudge_y = 500,
size = 6,
show.legend = FALSE,
fontface="bold",
segment.linetype = 'dotted') +
geom_label_repel(data = . %>%
filter(date == max(date) & fy == "2023"),
aes(label = scales::label_dollar(a = 1)(deficit_sum)),
nudge_x = 1.8,
size = 5,
show.legend = FALSE,
fontface="bold",
segment.linetype = 'dotted') +
geom_label_repel(data = . %>%
filter(date == max(date) & fy == "2024"),
aes(label = scales::label_dollar(a = 1)(deficit_sum)),
nudge_y = 300,
nudge_x = 1.8,
size = 5,
show.legend = FALSE,
fontface="bold",
segment.linetype = 'dotted') +
geom_label_repel(data = . %>%
filter(date == max(date) & fy == "2022"),
aes(label = scales::label_dollar(a = 1)(deficit_sum)),
nudge_y = -650,
size = 5,
show.legend = FALSE,
fontface="bold",
segment.linetype = 'dotted') +
theme_minimal()+
p_theme_side_tail+
guides(colour = guide_legend(override.aes = list(size=3))) +
labs(x        =  chartdate$xaxis,
y        =  chartdate$yaxis,
title    =  chartdate$title,
subtitle =  chartdate$subtitle,
caption  =  chartdate$caption)
