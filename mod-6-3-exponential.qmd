---
title: "Exponential Distributions"
format:
  html:
    toc: true
    toc-depth: 3
    toc-location: right
    self-contained: false     # must be false when using webr
urlcolor: blue
filters:
  - webr
execute:
  webR: true
editor: 
  markdown: 
    wrap: 72
---

```{r setup, echo = FALSE, message = FALSE}

library(dplyr, quietly = TRUE)
library(ggplot2, quietly = TRUE)
library(kableExtra, quietly = TRUE)
library(tidyquant, quietly = TRUE)

```

## Exponential Distribution

The **exponential probability distribution** is the probability
distribution of the time between events in a **Poisson process**.

An assumption is that events occur continuously and independently at a
constant average rate

The exponential probability distribution is **memoryless**, that is, the
distribution of 'waiting time' until a certain event does not depend on
how much time has elasped.

$$P(X > s+t | X > t) = P(X > s)$$

The probability density function of the exponential probability
distribution is:
$$P(x;\lambda) = \lambda \, e^{-\lambda \, x} \quad \forall \, x \ge 0$$

$$P(x;\lambda) = 0 \quad \forall \, x < 0$$

$\lambda$ is the parameter of the distribution and can be thought of as
the **rate parameter**.

## Exponential Properties

Let $\mu$ be the expected value or mean of the exponential probability
distribution.

Let $\mu$ also be defined in terms of the rate parameter $\lambda$ or:

$$E[x] = \mu = \frac{1}{\lambda}$$

$$var(x) = \frac{1}{\lambda^2}$$

The PDF of the exponential distribution can also be stated as:

$$f(x;\mu) = \frac{1}{\mu} \, e^{-(x/ \mu)} \quad \forall \, x \ge 0, \quad 0 \, \text{otherwise}$$

Given this discussion, we can state the CDF of the exponential
distribution in two ways:

$$F(x;\lambda) = \int_{-\infty}^{x} \, f(x) dx = 1 - e^{\lambda \, x} \quad \forall \, x \ge 0, \quad 0 \, \text{otherwise}$$

$$F(x;\mu) = 1 - e^{-x_o / \mu} \quad \forall \, x \ge 0, \quad 0 \, \text{otherwise}$$

## Exponential Example

Assume the time a customer spends in a bank is exponentially distributed
with mean 15 minutes

-   What is the probability that a customer spends less than six minutes
    in the bank?

-   What is the probability that a customer spends more than 20 minutes?

-   What is the probability that a customer spends between 12 and 18
    minutes?

-   What the number of minutes that separates the lowest 20% of
    customers from the others?

-   What is the number of minutes that separates the top 15% of
    customers from the others?

```{r, warning = FALSE, message = FALSE}

rm(list = ls())

set.seed(123)

library(dplyr)
library(kableExtra)

mu = 15
lambda = 1/mu

exp_1 <- tibble(q1 <- pexp(6, lambda, lower.tail = TRUE),
                q2 <- pexp(20, lambda, lower.tail = FALSE),
                q3 <- pexp(18, lambda, lower.tail = TRUE) -
                      pexp(12, lambda, lower.tail = TRUE),
                q4 <- qexp(0.2, lambda, lower.tail = TRUE),
                q5 <- qexp(0.86, lambda, lower.tail = FALSE))

kable(exp_1,
      align     = 'c',
      digits    = 3,
      caption   = 'Exponential Distribution Example',
      col.names = c('P(X < 6)', 
                    'P(X > 20)', 
                    'P(12 < X < 18)',
                    'P(20)', 
                    'P(85)')) %>%
kable_styling(font_size = 12)

```

## Random Exponential

**rexp** generates random deviates using the exponential PDF.

The constant rate $\lambda$ describes the arrival rate per each time
unit.

We can simulate arrival times $x$ arriving at rate $\lambda = 15$ per
time unit.

We simulate 3 columns of random exponential observations.

Note that $E[x] = \mu = 1\lambda = 1/15 = 0.067$

```{r, warning = FALSE, message = FALSE}

rm(list = ls())

set.seed(123)

library(dplyr)
library(kableExtra)

exp_list <- list()

lambda <- 15

ran_exp <- tibble(replicate(3, rexp(5, lambda)))

kable(ran_exp[1:5,],
      align     = 'c',
      caption   = 'Exponential Random Observations',
      col.names = c('1', '2', '3')) %>%
kable_styling(font_size = 12)

```

## Exponential Plot

Here we can use the **dexp** function to generate probabilities that are
then graphed to provide a visual representation of the exponential
distribution.

We generate observations that are exponentially distributed using the
**rexp** function with $\lambda = 5$

Recall that this means that $E(x) = \mu = 1/\lambda = 1/5$.

We compare that to the exponential distribution where $\lambda = 10$.

```{r, warning = FALSE, message = FALSE}

rm(list = ls())

set.seed(123)

library(dplyr)
library(kableExtra)

lambda = 5

df_exp <- tibble(x = seq(0,1, by = 0.001),
                 y = dexp(x, rate = 5))

ggplot(data = df_exp, 
       aes(x = x,
           y = y)) +
geom_line(linewidth = 1.2,
          color = "dark blue") +
stat_function(fun = dexp,
              args = list(rate = 10),
              color = "red") +
theme_minimal() +
labs(x = "x",
     y = "f(x)")


```

## Wrapping Up

A continuous probability distribution is where the random variable **X**
can take on any value.

Since there are infinite values for **X**, the probability of **X**
taking on a specific value is 0, that is, $P(X = x) = 0$.

Instead, we often examine the probability of $P(X \le x)$ or $P(X > x)$.

There are numerous continuous probability distributions, we examined the
uniform, normal, and exponential probability distributions.

The most commonly used continuous probability distribution is the normal
distribution.

We have used the **empirical rule**, that is, 68%-95%-99.7% rule to
discuss the proportion of observations that lie within 1,2,and 3
standard deviations of the mean.

We can now be much more precise with regards to this question.
