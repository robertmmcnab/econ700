---
title: "Uniform Distributions"
format:
  html:
    toc: true
    toc-depth: 3
    toc-location: right
    self-contained: false     # must be false when using webr
urlcolor: blue
filters:
  - webr
execute:
  webR: true
editor: 
  markdown: 
    wrap: 72
---

```{r setup, echo = FALSE, message = FALSE}

library(dplyr, quietly = TRUE)
library(ggplot2, quietly = TRUE)
library(kableExtra, quietly = TRUE)
library(tidyquant, quietly = TRUE)

```

## Discrete Random Variables

A **random variable** is a numerical description of an outcome of an
example.

A **discrete random variable** may assume a **finite** of **infinite**
number of values.

The **probability mass function** or **PMF**, $P(X)$, generates the
probability of $X$ occurring for a specific value of $x$.

The probability mass function is also referred to as the **discrete
probability density function**.

The **cumulative distribution function** or **CDF** generates the
probability of $X$ being less than or equal to a specific value of $x$.

The cumulative distribution function is also referred to as the
**discrete cumulative density function**.

Given a binomial experiment with the following properties, answer the
following questions using either the PDF or CDF.

-   $n = 50$

-   $p = .8$

-   $x = 42$

-   What is $P(X = x) = P(X = 42)$?

-   What is $P(X \le x) = P(X \le 42)$?

-   What is $P(X > x) = 1 - P(X \le X) = 1 - P(X \le 42)$?

```{r}

rm(list = ls())

library(dplyr)
library(kableExtra)

n = 50
p = .8
x = 42

probs <- tibble(p_1 <- dbinom(x, n, p),
                p_2 <- pbinom(x, n, p),
                p_3 <- pbinom(x, n, p, lower.tail = FALSE))

kable(probs,
      align = 'c',
      digits = 3,
      col.names = c('P(X = 42)', 'P(X <= 42)', 'P(X > 42)')) %>%
kable_classic()

```

## Continuous Random Variables

A **continuous random variable** may assume any value in an interval or
collection of intervals.

The **probability density function**, $f(x)$, is the counterpart of the
discrete probability density function.

The probability density function for a continuous random variable is
typically referred to as the **PDF**.

The PDF, $p(X)$, generates a curve for a given interval of $x$.

The PDF provides the probability that $x$ takes on any value in the
given interval of $x$.

This implies that the area under $p(X)$ for a specific value of $x$ is
zero.

In other words, given a continuous random value, the probability that
the continuous variable, $x$, is equal to a specific value is zero.

## Uniform Probability Distribution

The **continuous uniform probability distribution** describes an
experiment where there is a random outcome that is within specific
bounds.

The bounds of the random outcome are defined by the parameters, $a$ and
$b$.

-   $a$ is the minimum value of the random outcome.

-   $b$ is the maximum value of the random outcome.

The uniform distribution is defined by the parameters $a$ and $b$ which
define the region where the density function $p(x)$ is constant and
outside of which $p(x) = 0$. Since the area under the probability
density function must total 1, the probability density function of the
continuous uniform distribution is:

$$P(x | a,b)  = \frac{1}{b-a} \quad \text{for} \, x\in[a,b]$$

$$P(x |a,b) = 0 \quad \text{for} \, x \not\in[a,b]$$

We often denote the random variable $X$ as uniformly distributed on the
interval $[a,b]$ as:

$$
X \sim U(a,b)
$$

## PDF of Continuous Uniform

The PDF of the continuous uniform probability distribution is

$$P(x|a,b)  = \frac{1}{b-a} \quad \text{for} \, x\in[a,b]$$

$$\text{for} \, x \in[10,30]$$

For a continuous probability distribution, we know that:

$$P(x) \ge 0$$ $$\int_{-\infty}^{\infty} \, f(x) \, dx = 1$$

For the continuous uniform distribution:

$$a < b \rightarrow \frac{1}{b-a} \ge 0 \quad \forall \, a \le x \le b \rightarrow \, f(x) \ge 0 \quad \forall x$$

This means that $f(x) \ge 0$ for all $x \in [a,b]$.

Does the area defined by the PDF equal to one?

Here we can integrate the PDF and note that when $x < a$ and $x > b$
that $f(x) = 0$.

$$lim_{n \rightarrow \infty} \int_{-n}^{n} f(x)d(x) = lim_{n \rightarrow \infty} \int_{-n}^{a} (0)d(x) +\int_{a}^{b} \frac{1}{b-a}dx + \int_{b}^{n} (0)d(x)$$

$$lim_{n \rightarrow \infty} \int_{-n}^{n} f(x)d(x) = \frac{1}{b-a}[x]_{b}^{a} = \frac{1}{b-a}(b -a) = 1$$

The PDF of the continuous uniform probability distribution fulfills the
conditions for a PDF of a continuous random variable.

The continuous uniform is often referred to as a rectangular
distribution given the shape of its PDF.

In the following code, we create a tibble with the following variables:

-   A sequence of numbers from 0 to 40, in 0.01 increments

-   The probabilities associated with a continuous uniform with a = 10
    and b = 30 for the numbers

-   A plot with the numbers on the x-axis and the probabilities on the
    y-axis

```{webr-r}

uni_graph <- tibble(x  = seq(0,40, by = 0.01), 
                    fx = dunif(x, min = 10, max = 30))

ggplot(uni_graph,
       aes(x = x,
           y = fx)) +
geom_line() +
theme_minimal() + 
labs(x = "x",
     y = "P(x)")
```

## Uniform Example

-   Let the continuous uniform distribution be defined over $[a,b]$.

-   The probability that $x$ is in specific interval $[c,d]$ is:

$$P(c \le x \le d) = \int_{c}^{d} f(x) dx = \int_{c}^{d} \frac{1}{b-a}dx$$

$$P(c \le x \le d) = \int_{c}^{d} \frac{1}{b-a} [x]_x^d = \frac{1}{b-a}(d-c) = \frac{d-c}{b-a}$$

Let an elevator arrive randomly between 10 and 30 seconds after a button
is pushed.

What is the probability that the elevator arrives between 15 and 20
seconds?

$$P(15 \le x \le 20) = \frac{20-15}{30-10} = 0.25$$

## CDF of Continuous Uniform

Given a uniform distribution defined over $[a,b]$, what is $P(X \le x)$
if $a < x < b$.

We have found that $P(c \le x \le d) = \frac{d - c}{b - c}$, so

$$F_X(x) = P(X \le x) = \int_{-\infty}^{x} f_x(t)dt$$

$$F_X(d) = \int_{-\infty}^{a}f_x(t)dt + \int_{a}^{x}f_x(t)dt$$

$$F_X(d) = \int_{-\infty}^{a}0 \, dt + \int_{a}^{x} \frac{1}{b-a}dt = \frac{1}{b-a} \, [t]_a^x = \frac{x-a}{b-a}$$

This yields the properties of the CDF of the uniform probability
distribution:

$$F_X(x) = 0 \quad \forall x \le a$$

$$F_X(x) = \frac{x-a}{b-a} \quad a < x < b$$

$$F_X(x) = 1 \quad \forall x \ge b$$

## Example of PDF and CDF

We can use the **dunif** and **punif** functions in R.

The **dunif** function calculates the uniform density function.

The **punif** function calculates the cumulative uniform density
function.

Assume that the $a = 10$ and $b=30$ then $f(x) =$ `r dunif(20,10,30)`

We can find $P(15 \le x \le 20) = 0.25$ manually or by multiplying
$f(x)$ by the range of the interval.

We can also find $P(X < 20) = P(X \le 20)$ by using the cumulative
density function.

```{r}

a = 10
b = 30
c = 15
d = 20

d_uni_man <- 1/(b-a)
d_uni_calc <- dunif(c, min = a, max = b)

d_uni_man_range <- (d-c)/(b-a)
d_uni_calc_range <- (d-c)*dunif(20, min = a, max = b)

p_uni_man <- (d-a)/(b-a)
p_uni_calc <- punif(d, min = a, max = b)

uni_frame <- data.frame(d_uni_calc, d_uni_calc_range, 
                        p_uni_calc)

kable(uni_frame,
      align       = "ccc", 
      format.args = list(big.mark = ",", 
                         scientific = FALSE),
      caption     = "Continuous Uniform Distribution
                     a=10 and b=30",
      col.names   = c("f(x)", "P(15 < x < 20)", 
                      "P(X < 20)")) %>%
  kable_styling(font_size = 12)

```

## Expected Value

The expected value of a continuous uniform distribution is

$$\mu = E[x] = lim_{n \rightarrow \infty} \int_{-n}^{n} x \, f(x) \, dx$$

$$\mu = lim_{n \rightarrow \infty} \int_{-\infty}^{a} x \, f(x) \, dx + \int_{a}^{b} x \, f(x) \, dx + \int_{b}^{\infty} x \, f(x) \, dx$$

$$\mu = \int_{-\infty}^{a} x \, (0) \, dx + \int_{a}^{b} x \, \frac{1}{b-a} \, dx + \int_b^{\infty} x \, (0) \, dx$$

$$\mu = \int_{a}^{b} x \, \frac{1}{b-a} \, dx = \frac{1}{b-a} \int_a^b x \, dx = \frac{1}{2(b-a)} \, [x^2]_b^a$$

$$\mu = \frac{1}{2(b-a)} \, [x^2]_b^a = \frac{1}{2(b-a)}(b^2 - a^2) = \frac{(b - a)(b + a)}{2(b-a)}$$

$$\mu = E[x] = \frac{a+b}{2}$$

## Expected Value and Variance

The expected value of a continuous uniform distribution is:

$$\mu = E[x] = \frac{a+b}{2}$$

The variance of a continuous uniform distribution is:

$$\sigma^2 = var(x) = \frac{(b-a)^2}{12}$$

Let $a = 10$ and $b = 30$ and $x$ be continuously, uniformly distributed
over this range.

$$\mu = \frac{a+b}{2} = \frac{10+30}{2} = 20$$

$$\sigma^2 = \frac{(b-a)^2}{12} = \frac{(30-10)^2}{12} = 33.33$$

$$\sigma = \frac{\sqrt{3}(b-a)}{6} = \frac{\sqrt{3}(30-10)}{6} = 5.78$$

## Uniform Inverse CDF

**qunif** is the inverse cumulative density function for a continuous
uniform distribution.

Given $a = 30$ and $b = 70$, what is $x$ such that $P(X \le x) = 0.1$?

We can use the inverse CDF to generate $x$ given $p$.

We can use the CDF to generate $p$ given $x$.

Note that the probabilities are equal unlike the discrete CDF and
inverse CDF.

```{r}

x <- 1:100
a = 30
b = 70
p = 0.10

uni_frame <- tibble(inv_cdf <- qunif(p, min = a, max = b, lower.tail = TRUE),
                    cdf <- punif(inv_cdf, min = a, max = b, lower.tail = TRUE))

kable(uni_frame,
      align       = "cc", 
      caption     = "Inverse CDF and CDF",
      col.names   = c("Inverse CDF(p=0.1)", "CDF(X < 34)")) %>%
  kable_styling(font_size = 12)


```

## Uniform - Random Observations

**runif** generates random deviates using the uniform PDF.

Given $a$ and $b$, we can generate 5 observations from a uniform
distribution.

In this example, we use a loop to generate 3 sets of random observations
from a uniform distribution with $a = 30$ and $b = 70$.

```{r, message = FALSE}

a = 30
b = 70

uni_list <- list()

for(i in 1:3){
  temp <- runif(5, min = a, max = b)
  uni_list[[i]] <- temp
}

ran_unif <- bind_cols(uni_list)

kable(ran_unif,
      align     = "ccc",
      caption   = " Uniform Random Observations",
      col.names = c("1", "2", "3")) %>%
  kable_styling(font_size = 12)


```
